"use strict";!function(a){a.fn.editableGrid=function(b){function g(){return d.find('tr > td[data-editable="true"]').parent().each(function(b,c){var f=a(c),g={id:b};f.data("id",b);var i=f.data("key"),j=f.data("value"),k=f.data("type");"undefined"!=typeof i&&"undefined"!=typeof j&&""!==i.toString().trim()&&""!==j.toString().trim()&&(g.keyName=i,g[i]="number"===k?Number(j):j),f.find("td").each(function(b,c){var e=a(c),f=e.data("editable"),i=e.data("property"),j=e.text(),k=d.find("th:eq("+b+")").text(),l=e.data("type"),m=e.data("object-type");switch(l){case"number":j=Number(j);break;case"boolean":j="TRUE"===j.toString().toUpperCase().trim()||"1"===j.toString().trim()?!0:!1;break;default:j=j.trim()}"undefined"!=typeof i&&""!==i.toString().trim()?(i=i.toString().trim(),g[i]=j,e.data("col",i)):"undefined"!=typeof k&&""!==k.toString().trim()?(k=k.toString().trim(),g[k]=j,e.data("col",k.toString().trim())):(g[b]=j,e.data("col",b));var n=e.data("col");if("undefined"!=typeof f&&f===!0)switch(e.html(""),m){case"checkbox":e.append("<input type='checkbox' class='check-box' disabled='disabled'"+(j===!0?"checked='checked'":"")+" />"),e.css("text-align","center");break;case"select":var o=h(n);if(o){e.append("<select class='edit-mode' disabled='disabled'></select>");for(var p=e.find("select"),q=0,r=o.length;r>q;q++)a(p).append("<option value='"+o[q].value+"'>"+o[q].text+"</option>");a(p).val(j),e.append("<span class='view-mode'>"+a(p).find("option:selected").text()+"</span>")}else e.append("<span class='view-mode'>"+j+"</span>"),e.append("<input type='text' class='edit-mode' value='"+j+"' />");break;default:e.append("<span class='view-mode'>"+j+"</span>"),e.append("<input type='text' class='edit-mode' value='"+j+"' />")}}),e.push(g)}),(!f.hasOwnProperty("disableControls")||"undefined"!=typeof f.disableControls&&f.disableControls===!1)&&(d.after("<div id='divEditGridControls'></div>"),a("#divEditGridControls").append("<button type='button' id='btnEditGrid' class='view-mode'>Edit</button>"),a("#divEditGridControls").append("<button type='button' id='btnCancelGrid' class='edit-mode'>Cancel</button>"),a("#divEditGridControls").append("<button type='button' id='btnSaveGrid' class='edit-mode'>Save</button>"),a("#btnEditGrid").click(function(){c.edit(),f.hasOwnProperty("edit")&&"undefined"!=typeof f.edit&&f.edit()}),a("#btnCancelGrid").click(function(){c.cancel(),f.hasOwnProperty("cancel")&&"undefined"!=typeof f.cancel&&f.cancel()}),a("#btnSaveGrid").click(function(){var a=c.save();f.hasOwnProperty("save")&&"undefined"!=typeof f.save&&f.save(a)}),a("#divEditGridControls > button").css("margin","2px")),(!f.hasOwnProperty("disableBootstrapClasses")||"undefined"!=typeof f.disableBootstrapClasses&&f.disableBootstrapClasses===!1)&&(d.find("td").css("padding","2px"),d.find('td[data-editable="true"]').find('input[type!="checkbox"], select').addClass("form-control").css("padding","5px 5px 5px 5px").css("height","100%"),d.find('td[data-editable="true"]').find('input[type="checkbox"]').addClass("form-control").css("height","20px"),a("#divEditGridControls > button").addClass("btn btn-default")),d.find(".edit-mode").hide(),d.find(".view-mode").show(),a(".edit-mode").hide(),a(".view-mode").show(),!1}function h(a){var b=null;if("undefined"!=typeof f&&f.hasOwnProperty("columns")){var c=f.columns;if(c.length>0){var d=c.filter(function(b){return b.name.toString().toUpperCase().trim()===a.toString().toUpperCase().trim()});if("undefined"!=typeof d&&d.length>0){d=d[0];var g,e=typeof d.values;switch(console.log("type:",e),e.toString()){case"string":g=JSON.parse(d.values);break;case"object":g=d.values;break;default:g=null}if(g)if(b=[],d.hasOwnProperty("text")&&d.hasOwnProperty("value"))for(var h=0,i=g.length;i>h;h++)b.push({text:g[h][d.text],value:g[h][d.value]});else for(var h=0,i=g.length;i>h;h++)b.push({text:g[h],value:g[h]})}}}return b}var c=this,d=a(this),e=[],f=b;return c.edit=function(){return d.find(".edit-mode").show(),d.find(".view-mode").hide(),a(".edit-mode").show(),a(".view-mode").hide(),d.find("input[type='checkbox']").prop("disabled",!1),d.find("select").prop("disabled",!1),!1},c.cancel=function(){return d.find(".view-mode").show(),d.find(".edit-mode").hide(),a(".view-mode").show(),a(".edit-mode").hide(),d.find("input[type='checkbox']").prop("disabled",!0),d.find("select").prop("disabled",!0),d.find('tr > td[data-editable="true"]').parent().each(function(b,c){var d=a(c),f=d.data("id");d.find('td[data-editable="true"]').each(function(b,c){var d=a(c),g=d.data("object-type"),h=d.data("col"),i=e[f][h];switch(g){case"checkbox":d.find("input[type='checkbox']").prop("checked",i);break;case"select":d.find("select").val(i);break;default:d.find("input[type!='hidden']").val(i)}})}),!1},c.save=function(b){d.find(".view-mode").show(),d.find(".edit-mode").hide(),a(".view-mode").show(),a(".edit-mode").hide(),d.find("input[type='checkbox']").prop("disabled",!0),d.find("select").prop("disabled",!0);var c=[];return d.find('tr > td[data-editable="true"]').parent().each(function(b,d){var f=a(d),g=f.data("id"),h=!1,i={};if(e[g].hasOwnProperty("keyName")){var j=e[g].keyName;i[j]=e[g][j]}f.find("td").each(function(b,c){var d=a(c),f=d.data("col"),j=d.data("editable"),k=e[g][f],l=d.data("object-type"),m=d.data("type");if("undefined"!=typeof j&&j===!0){switch(l){case"checkbox":k=d.find("input[type='checkbox']").prop("checked");break;case"select":k=d.find("select").val(),d.find("span").text(d.find("select > option:selected").text());break;default:k=d.find("input[type!='hidden']").val(),d.find("span").text(k)}"number"===m&&""!==k&&(k=Number(k)),e[g][f]!==k&&(e[g][f]=k,h=!0)}i[f]=k}),h&&c.push(i)}),b?(b(c),!1):c},g(),c}}(jQuery);